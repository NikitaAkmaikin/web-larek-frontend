# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## ${\color{bisque}Установка \space и \space запуск}$
Для установки и запуска проекта необходимо выполнить команды

```cmd
npm install
npm run start
```

или

```cmd
yarn
yarn start
```
## ${\color{bisque}Сборка}$

```cmd
npm run build
```

или

```cmd
yarn build

Базовый код сотоит из Api, Component, EventEmitter, Model

1) Класс Api элемент для взаимодействия с внешними API:
    возможность отправлять GET и POST-запросы;

2) Класс EventEmitter - Брокер событий который имеет возможность:
   "on" - Установить обработчик на событие;
   "off" - Снять обработчик с события;
   "emit" - Инициировать событие с данными;
   "onAll" - Слушать все события;
   "offAll" - Сбросить все обработчики;
   "trigger" - Сделать коллбек триггер, генерирующий событие при вызове;


3) Класс Component - базовый для других компонетов имеет возможность:
    "toggleClass" - Переключить класс;
    "setText" - Установить текстовое содержимое;
    "setDisabled" - Сменить статус блокировки;
    "setHidden/setVisible" - Скрыть/Показать елемент;
    "setImage" - Установить изображение с алтернативным текстом;
    "render" - Вернуть корневой DOM-элемент;

4) Класс Model - абстрактный базовый класс для всех моделей данных в проекте. Он предоставляет универсальную структуру для управления данными и их взаимодействием с системой событий.
    "emitChanges" - сообщает всем что модель поменялась;


Компоненты модели данных:
1) Класс AppState
данный класс содержит состояние корзины, каталога товаров, заказа и ошибок валидации:
    "setCatalog" - Добавляет данные товара в поле каталога;
    "setBasket" - Добавляет данные товара в поле корзины;
    "removeBasket" - Убирает конкретный товар из корзины;
    "clearBasket" - Очищает всё корзину;
    "getTotal" - Получает сумму заказа;
    "setPreview" - Выводит карточки и добавляет id в поле "preview";
    "getClosedLots" - Сортеровка карточек на повторения;
    "validateOrder" - Проверка валидности "Order";
    "validateContact" - Проверка валидности "Order";
    "setOrderField" - Устанавливает поле заказа и проверяет валидность;
    "setContactField" - Устанавливает поля контакта и проверяет валидность;
    "updateFormErrors" - Обновляет ошибки формы и генерирует соответствующие события;


Компоненты представления состоят из Basket, Form, Modal, Success, AuctionAPI, Card, Order, Page:

1) Класс Basket данный компонент предназначен для вывода контента в модальном окне Корзины, в данном компоненте содержатся следующие поля:
    list - HTML-элемент со списком товаров в корзине;
    total - HTML-элемент содержащий итоговую сумму заказа;
    button - HTML-элемент для открытия следующего модального окна;

Методы: 
    "set items(items: HTMLElement[])" - принимает список элементов и размещает их в list;
    "set disabled(length: number)" - принимает аргументом длину списка товаров и разблокирует кнопку оформления;
    "set total(price: number)" - устанавливает итоговую сумму в соответствующий HTML-элемент;

2) Класс Form данный компонент предназначен для форм приложения, в компонент имеет следующие поля:
    "submit" - HTML-элемент кнопки подтверждения формы;
    "errors" - HTML-элемент для вывода ошибок валидации;

Методы:
    "set onInputChange(field: keyof T, value: string)" - Отвечает за вывод ошибки в разметку;
    "set valid(value: boolean)" - Для блокировки/разблокировки кнопки подтверждения;
    "set errors(value: string)" - Установки сообщения об ошибке;
    "render(state: Partial<T> & IFormState)" - вызывает родительский метод;

3) Класс Modal данный компонент предназначен за работу модальных окон и вывод в них контента, в данном компоненте содержатся следующие поля:
    "closeButton" - HTML-элемент кнопки закрытия модального окна;
    "content" - HTML-элемент с контентом.

Методы:
    "open/close" - открытия и закрытия модального окна;
    "render(data: IModalData)" - вызывает родительский метод и открывает модальное окно с отрисованным контентом;

4) Класс Success данный компонент предназначен для отображения окна с уведомлением об успешном заказе, в данном компоненте содержатся следующие поля:
    "description" - HTML-элемент, содержащий текст с количеством списанных средств;
    "close" - HTML-элемент кнопки закрытия окна

Методы:
    "set description(value: number)" - Устанавка текста цены заказа;


5) Класс LarekAPI расширяет базовый класс Api, данный компонент  предоставляет методы для работы с API, обеспечивает функциональность для получения списка карточек, информации о продуктах и оформления заказов.

Методы: 
    "getLotList" - Получить данные списока товаров с сервера;
    "getLotItem" - Получить данные конкретного товара по его ID;
    "orderLots" - Отправить данные заказа;

6) Класс Card данный компонент предназначен вывода данныч о товаре на страницу,
в данном компоненте содержатся следующие поля:
    category: string;
    title: string;
    description?: string | string[];
    image: string;
    price: string | number;
    itemIndex: number
 
Методы:
    "set/get id(value: string)" -  для установки id в соответвующие элементы на страницы;
    "set/get title(value: string)" -   для установки title в соответвующие элементы на страницы;
    "set/get price(value: string)" -  для установки price в соответвующие элементы на страницы;

7) Класс OrderForm данный компонент предназначен для работы с формой "Order", в данном компоненте содержатся следующие поля:
    button - HTML-элемент для открытия следующего модального окна;
    buttonCash - HTML-элемент кнопки "онлайн";
    buttonCard - HTML-элемент кнопки "При получении";
    address - HTML-элемент с инпутом для ввода адреса

Методы:
    "isSelected" - Данные о выбранной кнопки;
    "set address(value: string)" - Установка адреса доставки;
    "getAddress" - проверка адреса

8) Класс ContactForm данный компонент предназначен для работы с формой "contacts",имеет следующие поля:

email - HTML-элемент с инпутом для ввода электронной почты
phone - HTML-элемент с инпутом для ввода номера телефона

Методы:
    "set phone(value: string)" - Установка номера телефона;
    "set email(value: string)" - Установка адреса электронной почты;


9) Класс Page данный компонент предназначен вывода основных данных на страницу, компонент имеет следующие поля:
    "counter" - HTML-элемент счетчика количества товаров в корзине;
    "catalog" - HTML-элемент галереи с товарами;
    "wrapper" - HTML-элемент основного контейнер всей страницы;
    "basket" - HTML-элемент кнопки корзины;

Методы:
    "counter/catalog" - установки содержимого в соответвующие элементы на страницу;
    "locked" - Блокируем прокрутку страницы если открыта модалка;


```TypeScript
// интерфейс, описывающий карточку товара
export interface ILotItem {
    id: string;
    title: string;
    category: string;
    description?: string;
    image: string;
    price: string | number;
}

export type ILot = ILotItem;

// интерфейс описания товара
export interface IAppState {
    catalog: ILot[];
    basket: string[];
    preview: string | null;
    order: IOrder | null;
    loading: boolean;
}

// Интерфейс для формы заказа
export interface IOrderForm {
    payment: string;
    address: string;
}

// Интерфейс для контактной формы
export interface IContactForm {
    email: string;
    phone: string;
}

//Интерфейс для формы
export interface IOrder extends IOrderForm, IContactForm{
    total: number,
    items: string[];
}

```